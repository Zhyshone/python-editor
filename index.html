<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Python Code Editor v1.6</title>

<!-- Monaco Editor -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/loader.min.js"></script>

<!-- Styles -->
<style>
    body {
        margin: 0;
        background: #1e1e1e;
        overflow: hidden;
        font-family: "Consolas", "Courier New", monospace;
    }

    #topbar {
        padding: 10px;
        color: #92c8a3;
        font-size: 14px;
        background: #111;
        border-bottom: 1px solid #333;
    }

    #container {
        display: flex;
        height: calc(100vh - 40px);
    }

    #editorSection {
        width: 60%;
        height: 100%;
        background: #1e1e1e;
        border-right: 1px solid #444;
        position: relative;
    }

    #editor {
        width: 100%;
        height: calc(100% - 40px);
    }

    #runBtn {
        position: absolute;
        right: 10px;
        top: 5px;
        background: #66bb6a;
        border: none;
        padding: 6px 14px;
        border-radius: 5px;
        cursor: pointer;
        color: black;
        font-weight: bold;
    }

    #runBtn:hover {
        background: #55a45a;
    }

    #consoleSection {
        width: 40%;
        height: 100%;
        background: black;
        color: #00ff90;
        padding: 10px;
        font-size: 14px;
        overflow-y: auto;
        white-space: pre-wrap;
    }
</style>
</head>

<body>

<div id="topbar">
    Python Code Editor v1.6 <span style="color:#ccc;">by: Engr. Godofredo L. Lijuso Jr</span>
</div>

<div id="container">

    <!-- LEFT SIDE EDITOR -->
    <div id="editorSection">
        <button id="runBtn">Run â–¶</button>
        <div id="editor"></div>
    </div>

    <!-- RIGHT SIDE CONSOLE -->
    <div id="consoleSection" id="output">
        Loading Python runtime...
    </div>

</div>

<!-- Pyodide (Python in WASM) -->
<script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>

<script>
/* -------------------- Load Pyodide -------------------- */
let pyodideReady = false;
let pyodide = null;

async function loadPy() {
    document.querySelector("#consoleSection").textContent = "Loading Python runtime...";
    pyodide = await loadPyodide();
    document.querySelector("#consoleSection").textContent = "Python ready.";
    pyodideReady = true;
}
loadPy();

/* -------------------- Load Monaco Editor -------------------- */
require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs' }});

require(['vs/editor/editor.main'], function() {
    window.editor = monaco.editor.create(document.getElementById("editor"), {
        value:
`# Example program
name = input("Enter your name: ")
print("Hello,", name)
`,
        language: "python",
        theme: "vs-dark",
        fontSize: 15,
        minimap: { enabled: false }
    });
});

/* -------------------- Run Python Code -------------------- */
async function runCode() {
    if (!pyodideReady) {
        return alert("Pyodide still loading...");
    }

    const consoleEl = document.querySelector("#consoleSection");
    consoleEl.textContent = ""; // clear console

    const code = editor.getValue();

    // redirect Python stdout / stderr
    pyodide.setStdout({
        batched: (s) => consoleEl.textContent += s
    });
    pyodide.setStderr({
        batched: (s) => consoleEl.textContent += s
    });

    try {
        await pyodide.runPythonAsync(code);
    } catch (err) {
        consoleEl.textContent += "\nError:\n" + err;
    }
}

/* -------------------- Button Listener -------------------- */
document.getElementById("runBtn").onclick = runCode;
</script>

</body>
</html>
